# 模拟退火算法（SA）

参考博客：[模拟退火算法原理+应用（二）](https://blog.csdn.net/weixin_40562999/article/details/80853418?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160631302519724816648634%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=160631302519724816648634&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-80853418.first_rank_ecpm_v3_pc_rank_v2&utm_term=%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E7%AE%97%E6%B3%95&spm=1018.2118.3001.4449)

模拟退火其实也是一种贪心算法，但是它的搜索过程引入了随机因素。在迭代更新可行解时，以一定的概率来接受一个比当前解要差的解，因此有可能会跳出这个局部的最优解，达到全局的最优解。以下图为例，假定初始解为左边蓝色点A，模拟退火算法会快速搜索到局部最优解B，但在搜索到局部最优解后，不是就此结束，而是会以一定的概率接受到左边的移动。也许经过几次这样的不是局部最优的移动后会到达全局最优点D，于是就跳出了局部最小值。 

![20201125233142.png](https://github.com/metaphysicser/picture/blob/master/note/SA/20201125233142.png?raw=true)

根据热力学的原理，在温度为 时，出现能量差为 的降温的概率为 ，表示为: 


其中 是波尔兹曼常数，值为 ， 表示自然指数，且 。因此 ，所以 函数的取值范围是(0,1)。满足概率密度函数的定义。其实这条公式更直观意思就是：温度越高，出现一次能量差为 的降温的概率就越大；温度越低，则出现降温的概率就越小。



在实际问题中，这里的“一定的概率”的计算参考了金属冶炼的退火过程。假定当前可行解为，迭代更新后的解为，那么对应的“能量差”定义为： 


其对应的“一定概率”为： 


注：在实际问题中，可以设定 。因为 可以等价于一个参数 。如设定 、 ，等于直接设定 的效果。

### 二、模拟退火算法描述

1. 初始化：初始温度（充分大），温度下限（充分小），初始解状态(是算法迭代的起点)，每个值的迭代次数；
2. 对做第3至第6步；
3. 产生新解: ()；
4. 利计算增量，其中为优化目标；
5. 若(若寻找最小值，)则接受作为新的当前解，否则以概率接受作为新的当前解；
6. 如果满足终止条件则输出当前解作为最优解，结束程序。(终止条件通常取为连续若干个新解都没有被接受时终止算法。)；
7. 逐渐减少，且，然后转第2步。

![20201125233308.png](https://github.com/metaphysicser/picture/blob/master/note/SA/20201125233308.png?raw=true)

### 三、模拟退火算法的优缺点

模拟退火算法的应用很广泛，可以高效地求解NP完全问题，如货郎担问题(Travelling Salesman Problem，简记为TSP)、最大截问题(Max Cut Problem)、0-1背包问题(Zero One Knapsack Problem)、图着色问题(Graph Colouring Problem)等等，但其参数难以控制，不能保证一次就收敛到最优值，一般需要多次尝试才能获得（大部分情况下还是会陷入局部最优值）。观察模拟退火算法的过程，发现其主要存在如下三个参数问题：

　　**(1) 温度T的初始值设置问题** 
　　温度的初始值设置是影响模拟退火算法全局搜索性能的重要因素之一、初始温度高，则搜索到全局最优解的可能性大，但因此要花费大量的计算时间；反之，则可节约计算时间，但全局搜索性能可能受到影响。

　　**(2) 退火速度问题，即每个值的迭代次数** 
　　模拟退火算法的全局搜索性能也与退火速度密切相关。一般来说，同一温度下的“充分”搜索是相当必要的，但这也需要计算时间。循环次数增加必定带来计算开销的增大。

　　**(3) 温度管理问题** 
　　温度管理问题也是模拟退火算法难以处理的问题之一。实际应用中，由于必须考虑计算复杂度的切实可行性等问题，常采用如下所示的降温方式： 


注：为了保证较大的搜索空间， 一般取接近于1的值，如0.95、0.9。